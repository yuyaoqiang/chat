{"ast":null,"code":"/**\r\n * Extracts Epson flavored Makernotes which are equal to those of Olympus.\r\n */\nexports.extractMakernotes = function (data, makernoteOffset, tiffOffset) {\n  // List of vendor specific Makernote tags found on\n  // http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Olympus.html\n  var tags = {\n    0x0000: \"MakerNoteVersion\",\n    0x0001: \"MinoltaCameraSettingsOld\",\n    0x0003: \"MinoltaCameraSettings\",\n    0x0040: \"CompressedImageSize\",\n    0x0081: \"PreviewImageData\",\n    0x0088: \"PreviewImageStart\",\n    0x0089: \"PreviewImageLength\",\n    0x0100: \"ThumbnailImage\",\n    0x0104: \"BodyFirmwareVersion\",\n    0x0200: \"SpecialMode\",\n    0x0201: \"Quality\",\n    0x0202: \"Macro\",\n    0x0203: \"BWMode\",\n    0x0204: \"DigitalZoom\",\n    0x0205: \"FocalPlaneDiagonal\",\n    0x0206: \"LensDistortionParams\",\n    0x0207: \"CameraType\",\n    0x0208: \"TextInfo\",\n    0x0209: \"CameraID\",\n    0x020B: \"EpsonImageWidth\",\n    0x020C: \"EpsonImageHeight\",\n    0x020D: \"EpsonSoftware\",\n    0x0280: \"PreviewImage\",\n    0x0300: \"PreCaptureFrames\",\n    0x0301: \"WhiteBoard\",\n    0x0302: \"OneTouchWB\",\n    0x0303: \"WhiteBalanceBracket\",\n    0x0304: \"WhiteBalanceBias\",\n    0x0403: \"SceneMode\",\n    0x0404: \"SerialNumber\",\n    0x0405: \"Firmware\",\n    0x0E00: \"PrintIM\",\n    0x0F00: \"DataDump\",\n    0x0F01: \"DataDump2\",\n    0x0F04: \"ZoomedPreviewStart\",\n    0x0F05: \"ZoomedPreviewLength\",\n    0x0F06: \"ZoomedPreviewSize\",\n    0x1000: \"ShutterSpeedValue\",\n    0x1001: \"ISOValue\",\n    0x1002: \"ApertureValue\",\n    0x1003: \"BrightnessValue\",\n    0x1004: \"FlashMode\",\n    0x1005: \"FlashDevice\",\n    0x1006: \"ExposureCompensation\",\n    0x1007: \"SensorTemperature\",\n    0x1008: \"LensTemperature\",\n    0x1009: \"LightCondition\",\n    0x100A: \"FocusRange\",\n    0x100B: \"FocusMode\",\n    0x100C: \"ManualFocusDistance\",\n    0x100D: \"ZoomStepCount\",\n    0x100E: \"FocusStepCount\",\n    0x100F: \"Sharpness\",\n    0x1010: \"FlashChargeLevel\",\n    0x1011: \"ColorMatrix\",\n    0x1012: \"BlackLevel\",\n    0x1013: \"ColorTemperatureBG?\",\n    0x1014: \"ColorTemperatureRG?\",\n    0x1015: \"WBMode\",\n    0x1017: \"RedBalance\",\n    0x1018: \"BlueBalance\",\n    0x1019: \"ColorMatrixNumber\",\n    0x101A: \"SerialNumber\",\n    0x101B: \"ExternalFlashAE1_0?\",\n    0x101C: \"ExternalFlashAE2_0?\",\n    0x101D: \"InternalFlashAE1_0?\",\n    0x101E: \"InternalFlashAE2_0?\",\n    0x101F: \"ExternalFlashAE1?\",\n    0x1020: \"ExternalFlashAE2?\",\n    0x1021: \"InternalFlashAE1?\",\n    0x1022: \"InternalFlashAE2?\",\n    0x1023: \"FlashExposureComp\",\n    0x1024: \"InternalFlashTable\",\n    0x1025: \"ExternalFlashGValue\",\n    0x1026: \"ExternalFlashBounce\",\n    0x1027: \"ExternalFlashZoom\",\n    0x1028: \"ExternalFlashMode\",\n    0x1029: \"Contrast\",\n    0x102A: \"SharpnessFactor\",\n    0x102B: \"ColorControl\",\n    0x102C: \"ValidBits\",\n    0x102D: \"CoringFilter\",\n    0x102E: \"OlympusImageWidth\",\n    0x102F: \"OlympusImageHeight\",\n    0x1030: \"SceneDetect\",\n    0x1031: \"SceneArea?\",\n    0x1033: \"SceneDetectData?\",\n    0x1034: \"CompressionRatio\",\n    0x1035: \"PreviewImageValid\",\n    0x1036: \"PreviewImageStart\",\n    0x1037: \"PreviewImageLength\",\n    0x1038: \"AFResult\",\n    0x1039: \"CCDScanMode\",\n    0x103A: \"NoiseReduction\",\n    0x103B: \"FocusStepInfinity\",\n    0x103C: \"FocusStepNear\",\n    0x103D: \"LightValueCenter\",\n    0x103E: \"LightValuePeriphery\",\n    0x103F: \"FieldCount?\",\n    0x2010: \"Equipment\",\n    0x2020: \"CameraSettings\",\n    0x2030: \"RawDevelopment\",\n    0x2031: \"RawDev2\",\n    0x2040: \"ImageProcessing\",\n    0x2050: \"FocusInfo\",\n    0x2100: \"Olympus2100\",\n    0x2200: \"Olympus2200\",\n    0x2300: \"Olympus2300\",\n    0x2400: \"Olympus2400\",\n    0x2500: \"Olympus2500\",\n    0x2600: \"Olympus2600\",\n    0x2700: \"Olympus2700\",\n    0x2800: \"Olympus2800\",\n    0x2900: \"Olympus2900\",\n    0x3000: \"RawInfo\",\n    0x4000: \"MainInfo\",\n    0x5000: \"UnknownInfo\"\n  }; // Epson flavored Makernote data starts after eight bytes\n\n  var ifdOffset = makernoteOffset + 8; // Get the number of entries and extract them\n\n  var numberOfEntries = data.getShort(ifdOffset, this.isBigEndian);\n\n  if (this.options.epsonMaxEntries) {\n    numberOfEntries = Math.min(numberOfEntries, this.options.epsonMaxEntries);\n  }\n\n  var makernoteData = {};\n\n  for (var i = 0; i < numberOfEntries; i++) {\n    var exifEntry = this.extractExifEntry(data, ifdOffset + 2 + i * 12, tiffOffset, this.isBigEndian, tags);\n\n    if (exifEntry && exifEntry.tagName !== null) {\n      makernoteData[exifEntry.tagName] = exifEntry.value;\n    }\n  }\n\n  return makernoteData;\n};","map":null,"metadata":{},"sourceType":"script"}