{"ast":null,"code":"/**\r\n * Extracts Panasonic flavored Makernotes.\r\n */\nexports.extractMakernotes = function (data, makernoteOffset, tiffOffset) {\n  // List of vendor specific Makernote tags found on\n  // http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Panasonic.html\n  var tags = {\n    0x0001: \"ImageQuality\",\n    0x0002: \"FirmwareVersion\",\n    0x0003: \"WhiteBalance\",\n    0x0007: \"FocusMode\",\n    0x000f: \"AFAreaMode\",\n    0x001a: \"ImageStabilization\",\n    0x001c: \"MacroMode\",\n    0x001f: \"ShootingMode\",\n    0x0020: \"Audio\",\n    0x0021: \"DataDump\",\n    0x0023: \"WhiteBalanceBias\",\n    0x0024: \"FlashBias\",\n    0x0025: \"InternalSerialNumber\",\n    0x0026: \"PanasonicExifVersion\",\n    0x0028: \"ColorEffect\",\n    0x0029: \"TimeSincePowerOn\",\n    0x002a: \"BurstMode\",\n    0x002b: \"SequenceNumber\",\n    0x002c: \"ContrastMode\",\n    0x002d: \"NoiseReduction\",\n    0x002e: \"SelfTimer\",\n    0x0030: \"Rotation\",\n    0x0031: \"AFAssistLamp\",\n    0x0032: \"ColorMode\",\n    0x0033: \"BabyAge\",\n    0x0034: \"OpticalZoomMode\",\n    0x0035: \"ConversionLens\",\n    0x0036: \"TravelDay\",\n    0x0039: \"Contrast\",\n    0x003a: \"WorldTimeLocation\",\n    0x003b: \"TextStamp\",\n    0x003c: \"ProgramISO\",\n    0x003d: \"AdvancedSceneType\",\n    0x003e: \"TextStamp\",\n    0x003f: \"FacesDetected\",\n    0x0040: \"Saturation\",\n    0x0041: \"Sharpness\",\n    0x0042: \"FilmMode\",\n    0x0044: \"ColorTempKelvin\",\n    0x0045: \"BracketSettings\",\n    0x0046: \"WBShiftAB\",\n    0x0047: \"WBShiftGM\",\n    0x0048: \"FlashCurtain\",\n    0x0049: \"LongExposureNoiseReduction\",\n    0x004b: \"PanasonicImageWidth\",\n    0x004c: \"PanasonicImageHeight\",\n    0x004d: \"AFPointPosition\",\n    0x004e: \"FaceDetInfo\",\n    0x0051: \"LensType\",\n    0x0052: \"LensSerialNumber\",\n    0x0053: \"AccessoryType\",\n    0x0054: \"AccessorySerialNumber\",\n    0x0059: \"Transform\",\n    0x005d: \"IntelligentExposure\",\n    0x0060: \"LensFirmwareVersion\",\n    0x0061: \"FaceRecInfo\",\n    0x0062: \"FlashWarning\",\n    0x0063: \"RecognizedFaceFlags?\",\n    0x0065: \"Title\",\n    0x0066: \"BabyName\",\n    0x0067: \"Location\",\n    0x0069: \"Country\",\n    0x006b: \"State\",\n    0x006d: \"City\",\n    0x006f: \"Landmark\",\n    0x0070: \"IntelligentResolution\",\n    0x0077: \"BurstSpeed\",\n    0x0079: \"IntelligentD-Range\",\n    0x007c: \"ClearRetouch\",\n    0x0086: \"ManometerPressure\",\n    0x0089: \"PhotoStyle\",\n    0x008a: \"ShadingCompensation\",\n    0x008c: \"AccelerometerZ\",\n    0x008d: \"AccelerometerX\",\n    0x008e: \"AccelerometerY\",\n    0x008f: \"CameraOrientation\",\n    0x0090: \"RollAngle\",\n    0x0091: \"PitchAngle\",\n    0x0093: \"SweepPanoramaDirection\",\n    0x0094: \"SweepPanoramaFieldOfView\",\n    0x0096: \"TimerRecording\",\n    0x009d: \"InternalNDFilter\",\n    0x009e: \"HDR\",\n    0x009f: \"ShutterType\",\n    0x00a3: \"ClearRetouchValue\",\n    0x00ab: \"TouchAE\",\n    0x0e00: \"PrintIM\",\n    0x8000: \"MakerNoteVersion\",\n    0x8001: \"SceneMode\",\n    0x8004: \"WBRedLevel\",\n    0x8005: \"WBGreenLevel\",\n    0x8006: \"WBBlueLevel\",\n    0x8007: \"FlashFired\",\n    0x8008: \"TextStamp\",\n    0x8009: \"TextStamp\",\n    0x8010: \"BabyAge\",\n    0x8012: \"Transform\"\n  }; // Panasonic flavored Makernote data starts after twelve bytes\n\n  var ifdOffset = makernoteOffset + 12; // Get the number of entries and extract them\n\n  var numberOfEntries = data.getShort(ifdOffset, this.isBigEndian);\n\n  if (this.options.panasonicMaxEntries) {\n    numberOfEntries = Math.min(numberOfEntries, this.options.panasonicMaxEntries);\n  }\n\n  var makernoteData = {};\n\n  for (var i = 0; i < numberOfEntries; i++) {\n    var exifEntry = this.extractExifEntry(data, ifdOffset + 2 + i * 12, makernoteOffset, false, tags);\n    if (!exifEntry) break; // stop if exifEntry starts to return false, prevents a process out of memory\n\n    if (exifEntry && exifEntry.tagName) {\n      makernoteData[exifEntry.tagName] = exifEntry.value;\n    }\n  }\n\n  return makernoteData;\n};","map":null,"metadata":{},"sourceType":"script"}