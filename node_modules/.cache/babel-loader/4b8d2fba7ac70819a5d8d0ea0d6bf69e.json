{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import React,{useEffect,Suspense}from'react';import{Switch}from\"react-router-dom\";import{observer,inject}from\"mobx-react\";import AuthRoute from\"./utils/authRoute\";import{ping}from\"@pages/userInfo/request\";import{banks}from\"@pages/banks/request\";import{myStatus}from\"@pages/home/request\";import{useHistory}from\"react-router-dom\";import'./App.scss';import{transferArrayToObj}from'@utils/helpers';_Toast.config({duration:1.3});var id=0;var App=function App(props){var userState=props.userState,banksState=props.banksState,homeState=props.homeState;var user=userState.user,logout=userState.logout;var setBanks=banksState.setBanks;var changeData=homeState.changeData,data=homeState.data;var _useHistory=useHistory(),push=_useHistory.push;var pings=function pings(){ping({}).then(function(){}).catch(function(err){});};var myInfoHandle=function myInfoHandle(){myStatus({}).then(function(data){if(data.status==='DISABLE'){logout();push(\"/login\");}changeData(data);});};var banksStateHandle=function banksStateHandle(){banks().then(function(data){if(data&&data.length>0){var map=transferArrayToObj(data);setBanks(map,data);}});};useEffect(function(){if(user.isLogin){myInfoHandle();banksStateHandle();var _id=setInterval(function(){if(!user.isLogin)return;myInfoHandle();pings();},3000);return function(){return clearInterval(_id);};}},[user]);var displayStatus=function displayStatus(){return/*#__PURE__*/_jsx(\"p\",{className:\"status-icon\"});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:[user.isLogin&&data.status!=='NORMAL'&&displayStatus(),/*#__PURE__*/_jsx(Switch,{children:/*#__PURE__*/_jsx(AuthRoute,{})})]})});};export default inject('userState','banksState','homeState')(observer(App));","map":null,"metadata":{},"sourceType":"module"}