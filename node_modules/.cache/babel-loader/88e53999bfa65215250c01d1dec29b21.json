{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\n\nvar _jsxFileName = \"/Users/yuanfang/code/advisory-h5/src/pages/offTimer/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport HeaderBar from \"@components/header\";\nimport { useHistory } from \"react-router-dom\";\n//@ts-ignore\nimport lrz from \"lrz\";\nimport { cancelTask, myTaskDetail } from \"./request\"; //@ts-ignore\n\nimport './style.scss';\n\nconst OffTimer = () => {\n  _s();\n\n  const {\n    goBack\n  } = useHistory();\n  const [selectValue, setSelectValue] = useState(\"收款账号异常\");\n  const [imgUrl, setImgUrl] = useState(\"\");\n  const [detail, setDetail] = useState(null);\n  const [imgData, setImgData] = useState(null);\n  const [remark, setRemark] = useState(\"\");\n\n  const onChange = e => {\n    if (!e.target.files) return;\n    const file = e.target.files[0];\n\n    if (window.FileReader) {\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onloadend = function (e) {\n        //@ts-ignore\n        setImgData(e.target.result);\n      };\n\n      let data = new FormData();\n      data.append(\"file\", file, file.name);\n      setImgUrl(file);\n    }\n  };\n\n  const submit = () => {\n    if (selectValue === \"收款账号异常\" && !imgUrl) {\n      _Toast.info(\"需要上传凭证\");\n\n      return;\n    }\n\n    if (!remark) {\n      _Toast.info(\"需要填写备注\");\n\n      return;\n    }\n\n    const cancelReason = encodeURI(selectValue);\n    const remarks = encodeURI(remark);\n\n    _Toast.loading(\"提交中...\", 0);\n\n    if (!imgUrl) {\n      cancelTask(null, {\n        taskId: detail.taskOrderId,\n        cancelReason,\n        remark: remarks\n      }).then(data => {\n        _Toast.success(\"提交成功\");\n      }).catch(err => {\n        _Toast.fail(err.response.data.message);\n      });\n      return;\n    }\n\n    let data = new FormData();\n    lrz(imgUrl, {\n      quality: 0.1\n    }).then(function (rst) {\n      //@ts-ignore\n      data.append(\"file\", rst.file, imgUrl.name);\n      cancelTask(data, {\n        taskId: detail.taskOrderId,\n        cancelReason,\n        remark: remarks\n      }).then(data => {\n        _Toast.success(\"提交成功\");\n\n        goBack();\n      }).catch(err => {\n        _Toast.fail(err.response.data.message);\n      });\n    });\n  };\n\n  const myTaskDetailHandle = () => {\n    myTaskDetail({}).then(data => {\n      setDetail(data);\n    });\n  };\n\n  useEffect(() => {\n    myTaskDetailHandle();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(HeaderBar, {\n      goback: goBack,\n      title: \"取消付款\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"select-wrap\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u53D6\\u6D88\\u539F\\u56E0*\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"select\",\n        onChange: e => setSelectValue(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\",\n          children: \"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\",\n          children: \"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\\u5176\\u4ED6\",\n          children: \"\\u5176\\u4ED6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 16\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"select-wrap\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u8BF4\\u660E*\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        rows: 4,\n        maxLength: 30,\n        className: \"select\",\n        onChange: e => setRemark(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"timer-update\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"vlidate\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 36\n        }, this), \"\\u4E0A\\u4F20\\u51ED\\u8BC1\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"update-wrap\",\n        children: imgData ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"update-img\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"task-img\",\n            src: imgData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/png, image/jpeg, image/gif, image/jpg\",\n            multiple: false,\n            onChange: e => onChange(e)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 22\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"update-img\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/png, image/jpeg, image/gif, image/jpg\",\n            multiple: false,\n            onChange: e => onChange(e)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 22\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"submit-btn\",\n      onClick: submit,\n      children: \"\\u63D0\\u4EA4\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 10\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OffTimer, \"tPJMyx1emdwgoxEBqyGgUZWGrsM=\", false, function () {\n  return [useHistory];\n});\n\n_c = OffTimer;\nexport default OffTimer;\n\nvar _c;\n\n$RefreshReg$(_c, \"OffTimer\");","map":{"version":3,"sources":["/Users/yuanfang/code/advisory-h5/src/pages/offTimer/index.tsx"],"names":["React","useEffect","useState","HeaderBar","useHistory","lrz","cancelTask","myTaskDetail","OffTimer","goBack","selectValue","setSelectValue","imgUrl","setImgUrl","detail","setDetail","imgData","setImgData","remark","setRemark","onChange","e","target","files","file","window","FileReader","reader","readAsDataURL","onloadend","result","data","FormData","append","name","submit","info","cancelReason","encodeURI","remarks","loading","taskId","taskOrderId","then","success","catch","err","fail","response","message","quality","rst","myTaskDetailHandle","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport HeaderBar from \"@components/header\"\nimport { useHistory } from \"react-router-dom\";\nimport { Toast } from \"antd-mobile\"\n//@ts-ignore\nimport lrz from \"lrz\"\nimport { cancelTask, myTaskDetail } from \"./request\"\n//@ts-ignore\nimport './style.scss'\nconst OffTimer = () => {\n   const { goBack } = useHistory();\n   const [selectValue, setSelectValue] = useState<string>(\"收款账号异常\");\n   const [imgUrl, setImgUrl] = useState(\"\")\n   const [detail, setDetail] = useState<any>(null)\n   const [imgData, setImgData] = useState<any>(null)\n   const [remark, setRemark] = useState<any>(\"\")\n\n   const onChange = (e: any) => {\n      if (!e.target.files) return\n      const file = e.target.files[0];\n      if (window.FileReader) {\n         var reader = new FileReader();\n         reader.readAsDataURL(file);\n         reader.onloadend = function (e) {\n            //@ts-ignore\n            setImgData(e.target.result)\n         };\n         let data = new FormData();\n         data.append(\"file\", file, file.name)\n         setImgUrl(file)\n      }\n   }\n\n   const submit = () => {\n      if (selectValue === \"收款账号异常\" && !imgUrl) {\n         Toast.info(\"需要上传凭证\")\n         return;\n      }\n      if (!remark) {\n         Toast.info(\"需要填写备注\")\n         return;\n      }\n      const cancelReason = encodeURI(selectValue)\n      const remarks = encodeURI(remark)\n      Toast.loading(\"提交中...\",0)\n      if (!imgUrl) {\n         cancelTask(null, { taskId: detail.taskOrderId, cancelReason, remark: remarks }).then(data => {\n            Toast.success(\"提交成功\");\n         }).catch(err=>{\n            Toast.fail(err.response.data.message)\n         })\n         return;\n      }\n      let data = new FormData();\n      lrz(imgUrl,{quality:0.1}).then(function (rst:any) {\n         //@ts-ignore\n         data.append(\"file\", rst.file, imgUrl.name)\n         cancelTask(data, { taskId: detail.taskOrderId, cancelReason, remark: remarks }).then(data => {\n            Toast.success(\"提交成功\");\n            goBack();\n         }).catch(err=>{\n            Toast.fail(err.response.data.message)\n         })\n       })\n\n   }\n   const myTaskDetailHandle = () => {\n      myTaskDetail({}).then((data: any) => {\n         setDetail(data)\n      })\n   }\n   useEffect(() => {\n      myTaskDetailHandle()\n   }, [])\n   return (\n      <>\n         <HeaderBar goback={goBack} title={\"取消付款\"} />\n         <p className=\"select-wrap\">\n            <span>取消原因*</span>\n            <select className=\"select\" onChange={(e) => setSelectValue(e.target.value)}>\n               <option value=\"收款账号异常\">收款账号异常</option>\n               <option value=\"自身资金不足\">自身资金不足</option>\n               <option value=\"其他\">其他</option>\n            </select>\n         </p>\n         <p className=\"select-wrap\">\n            <span>说明*</span>\n            <textarea rows={4} maxLength={30} className=\"select\" onChange={(e) => setRemark(e.target.value)}>\n            </textarea>\n         </p>\n         <div className=\"timer-update\">\n            <p className=\"vlidate\"><span>*</span>上传凭证</p>\n            <p className=\"update-wrap\">\n               {\n                  imgData ?\n                     <span className=\"update-img\">\n                        <img className=\"task-img\" src={imgData} />\n                        <input type=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" multiple={false} onChange={(e) => onChange(e)} />\n                     </span>\n                     :\n                     <span className=\"update-img\">\n                        <input type=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" multiple={false} onChange={(e) => onChange(e)} />\n                     </span>\n               }\n            </p>\n         </div>\n         <p className=\"submit-btn\" onClick={submit}>提交</p>\n      </>\n\n   )\n}\nexport default OffTimer;"]},"metadata":{},"sourceType":"module"}