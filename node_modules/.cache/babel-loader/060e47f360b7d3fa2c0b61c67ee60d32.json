{"ast":null,"code":"import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import axios from'axios';var baseURL=process.env.NODE_ENV==='production'?'':'';var timeout=12000;var reqeust=axios.create({timeout:timeout,transformRequest:[function(data){if(typeof data==='string'){return data;}data=JSON.stringify(data);return data;}],transformResponse:[function(data){if(typeof data==='string'&&data.startsWith('{')){data=JSON.parse(data);}return data;}]});// 请求拦截器\nreqeust.interceptors.request.use(function(config){var token=sessionStorage.getItem(\"user\");var url=sessionStorage.getItem(\"text-url\");var strToken=JSON.parse(token)||{};var hostname=window.location.hostname;if(process.env.NODE_ENV==='production'){config.url=url?\"\".concat(url).concat(baseURL).concat(config.url):\"http://\".concat(hostname,\":8080\").concat(config.url);}else{config.url=\"\".concat(baseURL).concat(config.url);}config.headers.Authorization=strToken.Authorization;return config;},function(error){error.msg='服务器异常，请联系管理员！';return Promise.resolve(error);});/**\n *响应拦截器\n* 自定义状态处理\n*/reqeust.interceptors.response.use(function(response){var data=response.data,status=response.status;if(!data){return data;}if(typeof data==='string'&&(data.startsWith('{')||data.startsWith('['))){return JSON.parse(data);}else{return data;}},function(error){_Toast.fail(\"\".concat(error.response.data.code));return Promise.reject(error.response);});export default reqeust;","map":{"version":3,"sources":["/Users/yuanfang/Downloads/Telegram Desktop/封存/advisory-h5/src/request/request.ts"],"names":["axios","baseURL","process","env","NODE_ENV","timeout","reqeust","create","transformRequest","data","JSON","stringify","transformResponse","startsWith","parse","interceptors","request","use","config","token","sessionStorage","getItem","url","strToken","hostname","window","location","headers","Authorization","error","msg","Promise","resolve","response","status","fail","code","reject"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport { Toast } from 'antd-mobile';\nimport { Response } from './entity.d';\nconst baseURL: string = process.env.NODE_ENV === 'production' ? '' : '';\nconst timeout: number = 12000;\n\nconst reqeust = axios.create({\n timeout,\n transformRequest: [(data) => {\n  if (typeof (data) === 'string') {\n   return data\n  }\n  data = JSON.stringify(data)\n  return data\n }],\n transformResponse: [(data) => {\n  if (typeof data === 'string' && data.startsWith('{')) {\n   data = JSON.parse(data)\n  }\n  return data\n }]\n});\n\n// 请求拦截器\nreqeust.interceptors.request.use((config) => {\n const token: any = sessionStorage.getItem(\"user\")\n const url = sessionStorage.getItem(\"text-url\")\n const strToken = JSON.parse(token) || {}\n const hostname = window.location.hostname;\n if (process.env.NODE_ENV === 'production') {\n  config.url = url ? `${url}${baseURL}${config.url}` : `http://${hostname}:8080${config.url}`\n } else {\n  config.url = `${baseURL}${config.url}`\n }\n config.headers.Authorization = strToken.Authorization;\n return config\n}, (error) => {\n error.msg = '服务器异常，请联系管理员！'\n return Promise.resolve(error)\n})\n\n/**\n *响应拦截器\n* 自定义状态处理\n*/\nreqeust.interceptors.response.use((response: Response) => {\n const { data,status } = response\n if (!data) {\n  return data;\n }\n if (typeof data === 'string' && (data.startsWith('{') || data.startsWith('['))) {\n  return JSON.parse(data);\n } else {\n  return data\n }\n}, (error) => {\n Toast.fail(`${error.response.data.code}`)\n return Promise.reject(error.response)\n})\nexport default reqeust;"]},"metadata":{},"sourceType":"module"}