{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{myTaskDetail,ackTimingTask}from\"../request\";import{useHistory}from\"react-router-dom\";import{status}from\"./entity\";//@ts-ignore\nimport lrz from\"lrz\";import{mm_dd_hh_mm_ss2,mm_ss_zh,seconds}from\"@utils/dataTime\";import{copyArticle}from\"@utils/helpers\";import{bankNumberHide,toFixed}from\"@utils/numberUtils\";import'../style.scss';var TimerInfo=function TimerInfo(props){var _useHistory=useHistory(),push=_useHistory.push;var mapBanks=props.mapBanks;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),imgUrl=_useState2[0],setImgUrl=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),close=_useState4[0],setClose=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),detail=_useState6[0],setDetail=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),imgData=_useState8[0],setImgData=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),second=_useState10[0],setSecond=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showAll=_useState12[0],setShowAll=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showName=_useState14[0],setShowName=_useState14[1];var offOrder=function offOrder(){setClose(false);push(\"/offTimer\");};useEffect(function(){myTaskDetailHandle();var id=setInterval(function(){myTaskDetailHandle();},3000);return function(){return clearInterval(id);};},[]);var myTaskDetailHandle=function myTaskDetailHandle(){myTaskDetail({}).then(function(data){setDetail(data);setSecond(seconds(data.userLockTimeout));});};useEffect(function(){var interval;if(second>=0){interval=setInterval(function(){setSecond(function(preSecond){if(preSecond<=1){clearInterval(interval);return 0;}else{return preSecond-1;}});},1000);}return function(){return clearInterval(interval);};},[second]);var closeAlert=function closeAlert(){return/*#__PURE__*/_jsx(\"div\",{className:\"alert-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"on-sale-alert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"alert-top\",children:\"\\u63D0\\u793A\"}),/*#__PURE__*/_jsx(\"p\",{className:\"alert-min\",children:/*#__PURE__*/_jsx(\"div\",{className:\"item font-40\",children:\"\\u53D6\\u6D88\\u540E\\u8BF7\\u52FF\\u7EE7\\u7EED\\u6253\\u6B3E,\\u82E5\\u53D1\\u73B0\\u6076\\u5FC3\\u53D6\\u6D88\\u5C06\\u9650\\u5236\\u63A5\\u5355,\\u662F\\u5426\\u786E\\u5B9A\\u53D6\\u6D88\\uFF1F\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"alert-bottom\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setClose(false);},children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(\"span\",{onClick:offOrder,children:\"\\u786E\\u5B9A\"})]})]})});};var _onChange=function onChange(e){if(!e.target.files)return;var file=e.target.files[0];if(window.FileReader){var reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=function(e){//@ts-ignore\nsetImgData(e.target.result);};var data=new FormData();data.append(\"file\",file,file.name);setImgUrl(file);}};var submit=function submit(){if(!imgUrl){_Toast.info(\"请上传照片\");return;}var data=new FormData();lrz(imgUrl,{quality:0.1}).then(function(rst){//@ts-ignore\ndata.append(\"file\",rst.file,imgUrl.name);_Toast.loading(\"提交中...\",0);ackTimingTask(data,{taskId:detail.taskOrderId}).then(function(data){_Toast.success(\"提交成功\");myTaskDetailHandle();}).catch(function(err){_Toast.fail(err.response&&err.response.data&&err.response.data.message||'提交出错 ');});});};return/*#__PURE__*/_jsxs(_Fragment,{children:[close&&closeAlert(),detail&&detail.taskOrderId?/*#__PURE__*/_jsxs(\"div\",{className:\"timer-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"timer-info-top\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u4EFB\\u52A1\\u5355\\u53F7:\",detail.orderNo]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u9886\\u53D6\\u65F6\\u95F4:\",mm_dd_hh_mm_ss2(detail.takeTime)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u4EFB\\u52A1\\u5956\\u52B1:\",/*#__PURE__*/_jsx(\"i\",{}),detail.taskBonus]}),/*#__PURE__*/_jsxs(\"p\",{className:\"down\",children:[\"\\u4EFB\\u52A1\\u5012\\u8BA1\\u65F6:\",mm_ss_zh(second)]}),/*#__PURE__*/_jsx(\"div\",{className:\"time-down\",children:status[detail.status]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"alert-text\",children:\"\\u6C47\\u6B3E\\u65F6,\\u6240\\u6709\\u4FE1\\u606F\\u5FC5\\u987B\\u590D\\u5236,\\u5426\\u5219\\u540E\\u679C\\u81EA\\u8D1F\"}),detail.bank!=='ALIPAY'?/*#__PURE__*/_jsxs(\"div\",{className:\"form-data\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u5361\\u53F7: \",showAll?detail.cardNo:bankNumberHide(detail.cardNo),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){copyArticle(detail.cardNo);setShowAll(true);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[showName?/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u59D3\\u540D:\",detail.name]}):/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u59D3\\u540D: \",detail.name&&detail.name.slice(0,1),\"* \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){copyArticle(detail.name);setShowName(true);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u94F6\\u884C: \",mapBanks[detail.bank],\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(mapBanks[detail.bank]);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u5206\\u884C:  \",detail.branch,\"  \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.branch);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u91D1\\u989D: \",toFixed(detail.amount),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.amount);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"form-data\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u652F\\u4ED8\\u5B9D\\u8D26\\u53F7: \",showAll?detail.cardNo:bankNumberHide(detail.cardNo),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){copyArticle(detail.cardNo);setShowAll(true);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[showName?/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u652F\\u4ED8\\u5B9D\\u59D3\\u540D:\",detail.name]}):/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u652F\\u4ED8\\u5B9D: \",detail.name.slice(0,1),\"* \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){copyArticle(detail.name);setShowName(true);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u91D1\\u989D: \",toFixed(detail.amount),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.amount);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]})]}),detail.bank==='ALIPAY'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-data\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u652F\\u4ED8\\u5B9D\\u8D26\\u53F7: \",bankNumberHide(detail.cardNo),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.cardNo);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u652F\\u4ED8\\u5B9D\\u59D3\\u540D: \",detail.name.slice(0,1),\"* \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.name);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u91D1\\u989D: \",toFixed(detail.amount),\" \"]}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return copyArticle(detail.amount);},children:\"\\u67E5\\u770B\\u590D\\u5236\"})]})]}),['LOCKED','WAIT_PLATFORM_CHECK','SUBMIT_TIMEOUT'].includes(detail.status)?/*#__PURE__*/_jsx(_Fragment,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"timer-update\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"vlidate\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u4E0A\\u4F20\\u51ED\\u8BC1\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"update-wrap\",children:imgData?/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:true,onChange:function onChange(e){return _onChange(e);}})]}):/*#__PURE__*/_jsx(\"span\",{className:\"update-img\",children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e);}})})})]}),/*#__PURE__*/_jsx(\"p\",{className:imgUrl?\"submit open\":\"submit close\",onClick:function onClick(){return submit();},children:\"\\u63D0\\u4EA4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"off-submit\",onClick:function onClick(){return setClose(true);},children:\"\\u53D6\\u6D88\\u4ED8\\u6B3E\"}),\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"full\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"no-task-detail\",children:\"\\u6682\\u65E0\\u4EFB\\u52A1\\u6570\\u636E\"})]});};export default TimerInfo;","map":null,"metadata":{},"sourceType":"module"}