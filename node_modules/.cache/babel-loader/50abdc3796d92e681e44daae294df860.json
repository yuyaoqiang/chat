{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\n\nvar _jsxFileName = \"/Users/yuanfang/code/advisory-h5/src/App.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, Suspense } from 'react';\nimport { Switch } from \"react-router-dom\";\nimport { observer, inject } from \"mobx-react\";\nimport AuthRoute from \"./utils/authRoute\";\nimport { ping } from \"@pages/userInfo/request\";\nimport { banks } from \"@pages/banks/request\";\nimport { myStatus } from \"@pages/home/request\";\nimport { useHistory } from \"react-router-dom\";\nimport './App.scss';\nimport { transferArrayToObj } from '@utils/helpers';\n\n_Toast.config({\n  duration: 1.3\n});\n\nconst id = 0;\n\nconst App = props => {\n  _s();\n\n  const {\n    userState,\n    banksState,\n    homeState\n  } = props;\n  const {\n    user,\n    logout\n  } = userState;\n  const {\n    setBanks\n  } = banksState;\n  const {\n    changeData,\n    data\n  } = homeState;\n  const {\n    push\n  } = useHistory();\n\n  const pings = () => {\n    ping({}).then(() => {}).catch(err => {});\n  };\n\n  const myInfoHandle = () => {\n    myStatus({}).then(data => {\n      if (data.status === 'DISABLE') {\n        logout();\n        push(\"/login\");\n      }\n\n      changeData(data);\n    });\n  };\n\n  const banksStateHandle = () => {\n    banks().then(data => {\n      if (data && data.length > 0) {\n        let map = transferArrayToObj(data);\n        setBanks(map, data);\n      }\n    });\n  };\n\n  useEffect(() => {\n    if (user.isLogin) {\n      myInfoHandle();\n      banksStateHandle();\n      const id = setInterval(() => {\n        if (!user.isLogin) return;\n        myInfoHandle();\n        pings();\n      }, 3000);\n      return () => clearInterval(id);\n    }\n  }, [user]);\n\n  const displayStatus = () => {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"status-icon\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 12\n    }, this);\n  };\n\n  console.log(data);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Suspense, {\n      fallback: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 27\n      }, this),\n      children: [user.isLogin && data.status !== 'NORMAL' && displayStatus(), /*#__PURE__*/_jsxDEV(Switch, {\n        children: /*#__PURE__*/_jsxDEV(AuthRoute, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(App, \"uBDI7a4mpBgNOdcNScdX76G8kos=\", false, function () {\n  return [useHistory];\n});\n\n_c = App;\nexport default inject('userState', 'banksState', 'homeState')(observer(App));\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/yuanfang/code/advisory-h5/src/App.tsx"],"names":["React","useEffect","Suspense","Switch","observer","inject","AuthRoute","ping","banks","myStatus","useHistory","transferArrayToObj","config","duration","id","App","props","userState","banksState","homeState","user","logout","setBanks","changeData","data","push","pings","then","catch","err","myInfoHandle","status","banksStateHandle","length","map","isLogin","setInterval","clearInterval","displayStatus","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect,Suspense } from 'react';\nimport { Switch, } from \"react-router-dom\"\nimport { observer, inject } from \"mobx-react\";\nimport AuthRoute from \"./utils/authRoute\"\nimport { ping } from \"@pages/userInfo/request\"\nimport { banks } from \"@pages/banks/request\"\nimport { myStatus } from \"@pages/home/request\"\nimport { useHistory } from \"react-router-dom\"\nimport './App.scss';\nimport { Toast } from 'antd-mobile';\nimport { transferArrayToObj } from '@utils/helpers';\nToast.config({ duration: 1.3 })\nconst id = 0;\nconst App = (props: any) => {\n  const { userState, banksState, homeState } = props;\n  const { user,logout } = userState;\n  const { setBanks } = banksState;\n  const { changeData,data } = homeState;\n  const { push } = useHistory();\n  const pings = () => {\n    ping({}).then(() => { }).catch(err => {\n    })\n  }\n  const myInfoHandle = () => {\n    myStatus({}).then((data:any) => {\n      if(data.status === 'DISABLE'){\n        logout();\n        push(\"/login\")\n      }\n      changeData(data)\n    })\n  }\n  const banksStateHandle = () => {\n    banks().then((data: any) => {\n      if (data && data.length > 0) {\n        let map = transferArrayToObj(data)\n        setBanks(map, data)\n      }\n    })\n  }\n  useEffect(() => {\n    if (user.isLogin) {\n      myInfoHandle()\n      banksStateHandle()\n      const id = setInterval(() => {\n        if (!user.isLogin) return;\n        myInfoHandle()\n        pings();\n      }, 3000);\n      return () => clearInterval(id);\n    }\n  }, [user])\n  const displayStatus=()=>{\n    return <p className=\"status-icon\"></p>\n  }\n  console.log(data)\n  return (\n    <>\n      <Suspense fallback={<div>Loading...</div>}>\n        {user.isLogin && data.status!=='NORMAL' && displayStatus()}\n        <Switch>\n          <AuthRoute></AuthRoute>\n        </Switch>\n      </Suspense>\n    </>\n  )\n}\n\nexport default inject('userState', 'banksState', 'homeState')((observer(App)));"]},"metadata":{},"sourceType":"module"}