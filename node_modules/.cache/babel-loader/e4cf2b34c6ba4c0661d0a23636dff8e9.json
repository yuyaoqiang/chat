{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _slicedToArray from\"/Users/yuanfang/code/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import HeaderBar from\"@components/header\";import{useHistory}from\"react-router-dom\";//@ts-ignore\nimport lrz from\"lrz\";//@ts-ignore\nimport EXIF from\"exif-js\";import{cancelTaskUpload,myTaskDetail,cancelAckTiming}from\"./request\";//@ts-ignore\nimport'./style.scss';var OffTimer=function OffTimer(){var _useHistory=useHistory(),goBack=_useHistory.goBack;var _useState=useState(\"收款账号异常\"),_useState2=_slicedToArray(_useState,2),selectValue=_useState2[0],setSelectValue=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),detail=_useState4[0],setDetail=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),imgData=_useState6[0],setImgData=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),imgData2=_useState8[0],setImgData2=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),imgData3=_useState10[0],setImgData3=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),remark=_useState12[0],setRemark=_useState12[1];var _onChange=function onChange(e,index,cb){if(!e.target.files)return;var file=e.target.files[0];if(!file)return;var obj={};EXIF.getData(file,function(){obj=EXIF.getAllTags(file);});var data=new FormData();lrz(file,{quality:0.1}).then(function(rst){cb(rst.base64);//@ts-ignore\ndata.append(\"file\",rst.file,file.name);_Toast.loading(\"上传中...\",0);cancelTaskUpload(data,{taskId:detail.taskOrderId,appPackageNameEncoded:obj.UserComment,imgCreateTime:obj.Artist,imgIndex:index}).then(function(data){_Toast.success(\"上传成功\");}).catch(function(err){_Toast.fail(err.response&&err.response.data&&err.response.data.message||'提交出错 ');});});};var submit=function submit(){if(!remark){_Toast.info(\"需要填写备注\");return;}var cancelReason=encodeURI(selectValue);var remarks=encodeURI(remark);if(selectValue===\"收款账号异常\"){if(imgData||imgData2||imgData3){_Toast.loading(\"提交中...\",0);cancelAckTiming({taskId:detail.taskOrderId,cancelReason:cancelReason,remark:remarks}).then(function(data){_Toast.success(\"提交成功\");goBack();});return;}_Toast.info(\"需要上传凭证\");return;}else{_Toast.loading(\"提交中...\",0);cancelAckTiming({taskId:detail.taskOrderId,cancelReason:cancelReason,remark:remarks}).then(function(data){_Toast.success(\"提交成功\");goBack();});}};var myTaskDetailHandle=function myTaskDetailHandle(){myTaskDetail({}).then(function(data){setDetail(data);});};useEffect(function(){myTaskDetailHandle();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(HeaderBar,{goback:goBack,title:\"取消付款\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"select-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u53D6\\u6D88\\u539F\\u56E0*\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select\",onChange:function onChange(e){return setSelectValue(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\",children:\"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\",children:\"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5176\\u4ED6\",children:\"\\u5176\\u4ED6\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"select-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u8BF4\\u660E*\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:4,maxLength:30,className:\"select\",onChange:function onChange(e){return setRemark(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timer-update\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"vlidate\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u4E0A\\u4F20\\u51ED\\u8BC1\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"update-wrap\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[imgData&&/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e,1,setImgData);}})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[imgData2&&/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData2}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e,2,setImgData2);}})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[imgData3&&/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData3}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e,3,setImgData3);}})]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"submit-btn\",onClick:submit,children:\"\\u63D0\\u4EA4\"})]});};export default OffTimer;","map":null,"metadata":{},"sourceType":"module"}