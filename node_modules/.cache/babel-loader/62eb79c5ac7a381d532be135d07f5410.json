{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import\"antd-mobile/lib/pull-to-refresh/style/css\";import _PullToRefresh from\"antd-mobile/lib/pull-to-refresh\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _objectDestructuringEmpty from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"antd-mobile/lib/list-view/style/css\";import _ListView from\"antd-mobile/lib/list-view\";import React,{useEffect,useRef}from\"react\";import Header from\"./component/header\";import Tabs from\"./component/tabs\";import Match from\"./component/match\";import Publish from\"./component/publish\";import ReactDOM from\"react-dom\";import{useState}from\"react\";import{query,queryByType}from\"./request\";import'./style.scss';import{useHistory}from\"react-router-dom\";var listDataSource=new _ListView.DataSource({rowHasChanged:function rowHasChanged(row1,row2){return row1!==row2;}});var rData=[];var Pusher=function Pusher(){var ref=useRef(null);var childRef=/*#__PURE__*/React.createRef();var _useState=useState(5),_useState2=_slicedToArray(_useState,2),containerHeieght=_useState2[0],setContainerHeight=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),refreshing=_useState6[0],setRefreshing=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),pageNo=_useState8[0],setPageNo=_useState8[1];var _useState9=useState(20),_useState10=_slicedToArray(_useState9,1),pageSize=_useState10[0];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isLastPage=_useState12[0],setIsLastPage=_useState12[1];var _useState13=useState(listDataSource),_useState14=_slicedToArray(_useState13,2),dataSource=_useState14[0],setDataSource=_useState14[1];var _useState15=useState(undefined),_useState16=_slicedToArray(_useState15,2),check=_useState16[0],setCheck=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),tabData=_useState18[0],setTabData=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),datas=_useState20[0],setDatas=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),total=_useState22[0],setTotal=_useState22[1];var history=useHistory();var getRealHeight=function getRealHeight(){var htmlFont=Number(document.documentElement.style.fontSize.slice(0,2));var clientHeight=document.documentElement.clientHeight;//@ts-ignore\nvar top=ReactDOM.findDOMNode(ref.current).offsetTop;//@ts-ignore\nvar bottom=ReactDOM.findDOMNode(childRef.current).clientHeight;setContainerHeight((clientHeight-bottom-top)/htmlFont);onRefresh();};var onRefresh=function onRefresh(){setRefreshing(true);setIsLoading(true);queryByType({pageNo:1,pageSize:pageSize,data:{matchNameId:check}}).then(function(res){var _res$data=res.data,list=_res$data.list,isLastPage=_res$data.isLastPage;rData=list;setRefreshing(false);setIsLoading(false);setIsLastPage(isLastPage);setDataSource(dataSource.cloneWithRows(rData));setPageNo(2);});};var onEndReached=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(isLastPage||isLoading)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsLoading(true);queryByType({pageNo:pageNo,pageSize:pageSize,data:{matchType:check}}).then(function(res){var data=res.data.data;rData=[].concat(_toConsumableArray(rData),_toConsumableArray(data.list));setIsLastPage(data.isLastPage);setDataSource(dataSource.cloneWithRows(rData));setIsLoading(false);setPageNo(pageNo+1);});case 4:case\"end\":return _context.stop();}}},_callee);}));return function onEndReached(){return _ref.apply(this,arguments);};}();var row=function row(rowData,sectionID,rowID){return/*#__PURE__*/_jsx(Match,{data:rowData,changeCheck:updateDataSource},rowID);};// 获取tabs\nvar getTabs=function getTabs(){query({}).then(function(res){var data=res.data;if(data.length===0)return;var tab=data[0];setCheck(tab.id);setTabData(data);});};// 根据id获取数据\nvar getDataById=function getDataById(_ref2){_objectDestructuringEmpty(_ref2);queryByType({data:{matchType:check}}).then(function(res){setDatas(res.data);}).catch(function(err){setDatas([]);});};// 发布\nvar submit=function submit(){var pushData=[];rData.forEach(function(item){var id=item.id,firstRecommend=item.firstRecommend,secondRecommend=item.secondRecommend,sizeBallRecommend=item.sizeBallRecommend,secondSizeBallRecommend=item.secondSizeBallRecommend;if(firstRecommend||sizeBallRecommend){pushData.push({matchId:id,firstRecommend:firstRecommend,secondRecommend:secondRecommend,sizeBallRecommend:sizeBallRecommend,secondSizeBallRecommend:secondSizeBallRecommend});}});if(pushData.length===0){_Toast.success(\"请选择发布赛事\");return;}};//数据转换\nvar updateDataSource=function updateDataSource(item){var latest=[];var total=0;rData.forEach(function(data){if(data.id===item.id){latest.push(item);}else{latest.push(data);}});latest.map(function(item){if(item.firstRecommend||item.secondRecommend||item.sizeBallRecommend){total=total+1;}});rData=latest;setTotal(total);setDataSource(dataSource.cloneWithRows(latest));};useEffect(function(){getTabs();},[]);useEffect(function(){if(!check)return;setTotal(0);getRealHeight();},[check]);return/*#__PURE__*/_jsxs(\"div\",{className:\"pusher\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Tabs,{check:check,change:setCheck,datas:tabData,total:total}),/*#__PURE__*/_jsx(_ListView,{className:\"push-container\",ref:ref,style:{height:\"\".concat(containerHeieght,\"rem\")},dataSource:dataSource,renderFooter:function renderFooter(){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:isLoading?'正在加载中.....':'没有更多数据'});},renderRow:row,useBodyScroll:false//@ts-ignore\n,pullToRefresh:/*#__PURE__*/_jsx(_PullToRefresh,{refreshing:refreshing,onRefresh:onRefresh}),onEndReached:onEndReached,pageSize:20}),/*#__PURE__*/_jsx(Publish,{submit:submit,ref:childRef})]});};export default Pusher;","map":{"version":3,"sources":["/Users/yuanfang/Downloads/Telegram Desktop/封存/advisory-h5/src/pages/pusher/index.tsx"],"names":["React","useEffect","useRef","Header","Tabs","Match","Publish","ReactDOM","useState","query","queryByType","useHistory","listDataSource","DataSource","rowHasChanged","row1","row2","rData","Pusher","ref","childRef","createRef","containerHeieght","setContainerHeight","isLoading","setIsLoading","refreshing","setRefreshing","pageNo","setPageNo","pageSize","isLastPage","setIsLastPage","dataSource","setDataSource","undefined","check","setCheck","tabData","setTabData","datas","setDatas","total","setTotal","history","getRealHeight","htmlFont","Number","document","documentElement","style","fontSize","slice","clientHeight","top","findDOMNode","current","offsetTop","bottom","onRefresh","data","matchNameId","then","res","list","cloneWithRows","onEndReached","matchType","row","rowData","sectionID","rowID","updateDataSource","getTabs","length","tab","id","getDataById","catch","err","submit","pushData","forEach","item","firstRecommend","secondRecommend","sizeBallRecommend","secondSizeBallRecommend","push","matchId","success","latest","map","height","textAlign"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from \"react\"\nimport Header from \"./component/header\"\nimport Tabs from \"./component/tabs\"\nimport Match from \"./component/match\"\nimport Publish from \"./component/publish\"\nimport ReactDOM from \"react-dom\"\nimport { useState } from \"react\"\nimport { ListView, PullToRefresh } from \"antd-mobile\";\nimport { query, queryByType } from \"./request\"\nimport './style.scss'\nimport { Toast } from \"antd-mobile\"\nimport { useHistory } from \"react-router-dom\"\nconst listDataSource = new ListView.DataSource({\n rowHasChanged: (row1: any, row2: any) => row1 !== row2,\n});\nlet rData: any[] = []\nconst Pusher = () => {\n const ref: any = useRef(null);\n const childRef = React.createRef();\n const [containerHeieght, setContainerHeight] = useState(5)\n const [isLoading, setIsLoading] = useState(false);\n const [refreshing, setRefreshing] = useState(false);\n const [pageNo, setPageNo] = useState(1);\n const [pageSize] = useState(20);\n const [isLastPage, setIsLastPage] = useState(false);\n const [dataSource, setDataSource] = useState(listDataSource);\n const [check, setCheck] = useState<number | undefined>(undefined)\n const [tabData, setTabData] = useState<MatchType[]>([]);\n const [datas, setDatas] = useState<MatchData[]>([])\n const [total, setTotal] = useState(0)\n const history = useHistory();\n\n const getRealHeight = () => {\n  const htmlFont: number = Number(document.documentElement.style.fontSize.slice(0, 2));\n  const clientHeight: number = document.documentElement.clientHeight;\n  //@ts-ignore\n  const top = ReactDOM.findDOMNode(ref.current).offsetTop\n  //@ts-ignore\n  const bottom = ReactDOM.findDOMNode(childRef.current).clientHeight\n  setContainerHeight((clientHeight - bottom - top) / htmlFont);\n  onRefresh();\n }\n\n const onRefresh = () => {\n  setRefreshing(true)\n  setIsLoading(true)\n  queryByType({ pageNo: 1, pageSize, data: { matchNameId: check } }).then(res => {\n   const { list, isLastPage } = res.data;\n   rData = list\n   setRefreshing(false)\n   setIsLoading(false)\n   setIsLastPage(isLastPage)\n   setDataSource(dataSource.cloneWithRows(rData));\n   setPageNo(2)\n  })\n };\n\n const onEndReached = async () => {\n  if (isLastPage || isLoading) return;\n  setIsLoading(true)\n  queryByType({ pageNo, pageSize, data: { matchType: check } }).then(res => {\n   const { data } = res.data;\n   rData = [...rData, ...data.list]\n   setIsLastPage(data.isLastPage)\n   setDataSource(dataSource.cloneWithRows(rData));\n   setIsLoading(false)\n   setPageNo(pageNo + 1)\n  })\n };\n\n const row = (rowData: any, sectionID: any, rowID: any) => {\n  return (\n   <Match key={rowID} data={rowData} changeCheck={updateDataSource} />\n  );\n };\n\n // 获取tabs\n const getTabs = () => {\n  query({}).then(res => {\n   const data: MatchType[] = res.data;\n   if (data.length === 0) return;\n   const tab = data[0];\n   setCheck(tab.id);\n   setTabData(data);\n  })\n }\n\n // 根据id获取数据\n const getDataById = ({ }) => {\n  queryByType({ data: { matchType: check } }).then((res: any) => {\n   setDatas(res.data)\n  }).catch(err => {\n   setDatas([])\n  })\n }\n\n // 发布\n const submit = () => {\n  const pushData: any[] = []\n  rData.forEach((item: MatchData) => {\n   const { id, firstRecommend, secondRecommend, sizeBallRecommend, secondSizeBallRecommend } = item;\n   if (firstRecommend || sizeBallRecommend) {\n    pushData.push({ matchId: id, firstRecommend, secondRecommend, sizeBallRecommend, secondSizeBallRecommend })\n   }\n  })\n  if (pushData.length === 0) {\n   Toast.success(\"请选择发布赛事\");\n   return;\n  }\n }\n\n //数据转换\n const updateDataSource = (item: MatchData) => {\n  const latest = [] as MatchData[]\n  let total = 0;\n  rData.forEach(data => {\n   if (data.id === item.id) {\n    latest.push(item);\n   } else {\n    latest.push(data);\n   }\n  });\n\n  latest.map(item => {\n   if (item.firstRecommend || item.secondRecommend || item.sizeBallRecommend) {\n    total = total + 1\n   }\n  })\n  rData = latest;\n  setTotal(total)\n  setDataSource(dataSource.cloneWithRows(latest));\n }\n\n useEffect(() => {\n  getTabs();\n }, [])\n\n useEffect(() => {\n  if (!check) return;\n  setTotal(0)\n  getRealHeight()\n }, [check])\n\n return (\n  <div className=\"pusher\">\n   <Header />\n   <Tabs check={check} change={setCheck} datas={tabData} total={total} />\n   <ListView\n    className=\"push-container\"\n    ref={ref}\n    style={{ height: `${containerHeieght}rem` }}\n    dataSource={dataSource}\n    renderFooter={\n     () => {\n      return <div style={{ textAlign: 'center' }}>\n       {isLoading ? '正在加载中.....' : '没有更多数据'}\n      </div>\n     }\n    }\n    renderRow={row}\n    useBodyScroll={false}\n    //@ts-ignore\n    pullToRefresh={<PullToRefresh\n     refreshing={refreshing}\n     onRefresh={onRefresh}\n    />}\n    onEndReached={onEndReached}\n    pageSize={20}\n   />\n   <Publish submit={submit} ref={childRef} />\n  </div>\n )\n}\nexport default Pusher;"]},"metadata":{},"sourceType":"module"}