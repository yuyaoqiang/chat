{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _slicedToArray from\"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import HeaderBar from\"@components/header\";import{useHistory}from\"react-router-dom\";import{cancelTask,myTaskDetail}from\"./request\";//@ts-ignore\nimport'./style.scss';var OffTimer=function OffTimer(){var _useHistory=useHistory(),goBack=_useHistory.goBack;var _useState=useState(\"收款账号异常\"),_useState2=_slicedToArray(_useState,2),selectValue=_useState2[0],setSelectValue=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),imgUrl=_useState4[0],setImgUrl=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),detail=_useState6[0],setDetail=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),imgData=_useState8[0],setImgData=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),remark=_useState10[0],setRemark=_useState10[1];var _onChange=function onChange(e){if(!e.target.files)return;var file=e.target.files[0];if(window.FileReader){var reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=function(e){//@ts-ignore\nsetImgData(e.target.result);};var data=new FormData();data.append(\"file\",file,file.name);setImgUrl(file);}};var submit=function submit(){if(selectValue===\"收款账号异常\"&&!imgUrl){_Toast.info(\"需要上传凭证\");return;}if(!remark){_Toast.info(\"需要填写备注\");return;}var cancelReason=encodeURI(selectValue);var remarks=encodeURI(remark);_Toast.loading(\"提交中...\");if(!imgUrl){cancelTask(null,{taskId:detail.taskOrderId,cancelReason:cancelReason,remark:remarks}).then(function(data){_Toast.success(\"提交成功\");}).catch(function(err){_Toast.fail(\"提交失败\");});return;}var data=new FormData();//@ts-ignore\ndata.append(\"file\",imgUrl,imgUrl.name);cancelTask(data,{taskId:detail.taskOrderId,cancelReason:cancelReason,remark:remarks}).then(function(data){_Toast.success(\"提交成功\");goBack();}).catch(function(err){_Toast.fail(\"提交失败\");});};var myTaskDetailHandle=function myTaskDetailHandle(){myTaskDetail({}).then(function(data){setDetail(data);});};useEffect(function(){myTaskDetailHandle();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(HeaderBar,{goback:goBack,title:\"取消付款\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"select-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u53D6\\u6D88\\u539F\\u56E0*\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"select\",onChange:function onChange(e){return setSelectValue(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\",children:\"\\u6536\\u6B3E\\u8D26\\u53F7\\u5F02\\u5E38\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\",children:\"\\u81EA\\u8EAB\\u8D44\\u91D1\\u4E0D\\u8DB3\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5176\\u4ED6\",children:\"\\u5176\\u4ED6\"})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"select-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u8BF4\\u660E*\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:4,maxLength:30,className:\"select\",onChange:function onChange(e){return setRemark(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timer-update\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"vlidate\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u4E0A\\u4F20\\u51ED\\u8BC1\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"update-wrap\",children:imgData?/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e);}})]}):/*#__PURE__*/_jsx(\"span\",{className:\"update-img\",children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e);}})})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"submit-btn\",onClick:submit,children:\"\\u63D0\\u4EA4\"})]});};export default OffTimer;","map":{"version":3,"sources":["/Users/yuanfang/Downloads/Telegram Desktop/封存/advisory-h5/src/pages/offTimer/index.tsx"],"names":["React","useEffect","useState","HeaderBar","useHistory","cancelTask","myTaskDetail","OffTimer","goBack","selectValue","setSelectValue","imgUrl","setImgUrl","detail","setDetail","imgData","setImgData","remark","setRemark","onChange","e","target","files","file","window","FileReader","reader","readAsDataURL","onloadend","result","data","FormData","append","name","submit","info","cancelReason","encodeURI","remarks","loading","taskId","taskOrderId","then","success","catch","err","fail","myTaskDetailHandle","value"],"mappings":"yZAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,SAAP,KAAsB,oBAAtB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,OAASC,UAAT,CAAqBC,YAArB,KAAyC,WAAzC,CACA;AACA,MAAO,cAAP,CACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,iBACDH,UAAU,EADT,CACZI,MADY,aACZA,MADY,eAEkBN,QAAQ,CAAS,QAAT,CAF1B,wCAEbO,WAFa,eAEAC,cAFA,8BAGQR,QAAQ,CAAC,EAAD,CAHhB,yCAGbS,MAHa,eAGLC,SAHK,8BAIQV,QAAQ,CAAM,IAAN,CAJhB,yCAIbW,MAJa,eAILC,SAJK,8BAKUZ,QAAQ,CAAM,IAAN,CALlB,yCAKba,OALa,eAKJC,UALI,8BAMQd,QAAQ,CAAM,EAAN,CANhB,0CAMbe,MANa,gBAMLC,SANK,gBAQpB,GAAMC,CAAAA,SAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,CAAD,CAAY,CAC1B,GAAI,CAACA,CAAC,CAACC,MAAF,CAASC,KAAd,CAAqB,OACrB,GAAMC,CAAAA,IAAI,CAAGH,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAb,CACA,GAAIE,MAAM,CAACC,UAAX,CAAuB,CACpB,GAAIC,CAAAA,MAAM,CAAG,GAAID,CAAAA,UAAJ,EAAb,CACAC,MAAM,CAACC,aAAP,CAAqBJ,IAArB,EACAG,MAAM,CAACE,SAAP,CAAmB,SAAUR,CAAV,CAAa,CAC7B;AACAJ,UAAU,CAACI,CAAC,CAACC,MAAF,CAASQ,MAAV,CAAV,CACF,CAHD,CAIA,GAAIC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,QAAJ,EAAX,CACAD,IAAI,CAACE,MAAL,CAAY,MAAZ,CAAoBT,IAApB,CAA0BA,IAAI,CAACU,IAA/B,EACArB,SAAS,CAACW,IAAD,CAAT,CACF,CACH,CAdD,CAgBA,GAAMW,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CAClB,GAAIzB,WAAW,GAAK,QAAhB,EAA4B,CAACE,MAAjC,CAAyC,CACtC,OAAMwB,IAAN,CAAW,QAAX,EACA,OACF,CACD,GAAI,CAAClB,MAAL,CAAa,CACV,OAAMkB,IAAN,CAAW,QAAX,EACA,OACF,CACD,GAAMC,CAAAA,YAAY,CAAGC,SAAS,CAAC5B,WAAD,CAA9B,CACA,GAAM6B,CAAAA,OAAO,CAAGD,SAAS,CAACpB,MAAD,CAAzB,CACA,OAAMsB,OAAN,CAAc,QAAd,EACA,GAAI,CAAC5B,MAAL,CAAa,CACVN,UAAU,CAAC,IAAD,CAAO,CAAEmC,MAAM,CAAE3B,MAAM,CAAC4B,WAAjB,CAA8BL,YAAY,CAAZA,YAA9B,CAA4CnB,MAAM,CAAEqB,OAApD,CAAP,CAAV,CAAgFI,IAAhF,CAAqF,SAAAZ,IAAI,CAAI,CAC1F,OAAMa,OAAN,CAAc,MAAd,EACF,CAFD,EAEGC,KAFH,CAES,SAAAC,GAAG,CAAE,CACX,OAAMC,IAAN,CAAW,MAAX,EACF,CAJD,EAKA,OACF,CACD,GAAIhB,CAAAA,IAAI,CAAG,GAAIC,CAAAA,QAAJ,EAAX,CACA;AACAD,IAAI,CAACE,MAAL,CAAY,MAAZ,CAAoBrB,MAApB,CAA4BA,MAAM,CAACsB,IAAnC,EACA5B,UAAU,CAACyB,IAAD,CAAO,CAAEU,MAAM,CAAE3B,MAAM,CAAC4B,WAAjB,CAA8BL,YAAY,CAAZA,YAA9B,CAA4CnB,MAAM,CAAEqB,OAApD,CAAP,CAAV,CAAgFI,IAAhF,CAAqF,SAAAZ,IAAI,CAAI,CAC1F,OAAMa,OAAN,CAAc,MAAd,EACAnC,MAAM,GACR,CAHD,EAGGoC,KAHH,CAGS,SAAAC,GAAG,CAAE,CACX,OAAMC,IAAN,CAAW,MAAX,EACF,CALD,EAMF,CA7BD,CA8BA,GAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAM,CAC9BzC,YAAY,CAAC,EAAD,CAAZ,CAAiBoC,IAAjB,CAAsB,SAACZ,IAAD,CAAe,CAClChB,SAAS,CAACgB,IAAD,CAAT,CACF,CAFD,EAGF,CAJD,CAKA7B,SAAS,CAAC,UAAM,CACb8C,kBAAkB,GACpB,CAFQ,CAEN,EAFM,CAAT,CAGA,mBACG,wCACG,KAAC,SAAD,EAAW,MAAM,CAAEvC,MAAnB,CAA2B,KAAK,CAAE,MAAlC,EADH,cAEG,WAAG,SAAS,CAAC,aAAb,wBACG,mDADH,cAEG,gBAAQ,SAAS,CAAC,QAAlB,CAA2B,QAAQ,CAAE,kBAACY,CAAD,QAAOV,CAAAA,cAAc,CAACU,CAAC,CAACC,MAAF,CAAS2B,KAAV,CAArB,EAArC,wBACG,eAAQ,KAAK,CAAC,sCAAd,kDADH,cAEG,eAAQ,KAAK,CAAC,sCAAd,kDAFH,cAGG,eAAQ,KAAK,CAAC,cAAd,0BAHH,GAFH,GAFH,cAUG,WAAG,SAAS,CAAC,aAAb,wBACG,uCADH,cAEG,iBAAU,IAAI,CAAE,CAAhB,CAAmB,SAAS,CAAE,EAA9B,CAAkC,SAAS,CAAC,QAA5C,CAAqD,QAAQ,CAAE,kBAAC5B,CAAD,QAAOF,CAAAA,SAAS,CAACE,CAAC,CAACC,MAAF,CAAS2B,KAAV,CAAhB,EAA/D,EAFH,GAVH,cAeG,aAAK,SAAS,CAAC,cAAf,wBACG,WAAG,SAAS,CAAC,SAAb,wBAAuB,2BAAvB,8BADH,cAEG,UAAG,SAAS,CAAC,aAAb,UAEMjC,OAAO,cACJ,cAAM,SAAS,CAAC,YAAhB,wBACG,YAAK,SAAS,CAAC,UAAf,CAA0B,GAAG,CAAEA,OAA/B,EADH,cAEG,cAAO,IAAI,CAAC,MAAZ,CAAmB,MAAM,CAAC,6CAA1B,CAAwE,QAAQ,CAAE,KAAlF,CAAyF,QAAQ,CAAE,kBAACK,CAAD,QAAOD,CAAAA,SAAQ,CAACC,CAAD,CAAf,EAAnG,EAFH,GADI,cAMJ,aAAM,SAAS,CAAC,YAAhB,uBACG,cAAO,IAAI,CAAC,MAAZ,CAAmB,MAAM,CAAC,6CAA1B,CAAwE,QAAQ,CAAE,KAAlF,CAAyF,QAAQ,CAAE,kBAACA,CAAD,QAAOD,CAAAA,SAAQ,CAACC,CAAD,CAAf,EAAnG,EADH,EART,EAFH,GAfH,cA+BG,UAAG,SAAS,CAAC,YAAb,CAA0B,OAAO,CAAEc,MAAnC,0BA/BH,GADH,CAoCF,CAlGD,CAmGA,cAAe3B,CAAAA,QAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport HeaderBar from \"@components/header\"\nimport { useHistory } from \"react-router-dom\";\nimport { Toast } from \"antd-mobile\"\nimport { cancelTask, myTaskDetail } from \"./request\"\n//@ts-ignore\nimport './style.scss'\nconst OffTimer = () => {\n   const { goBack } = useHistory();\n   const [selectValue, setSelectValue] = useState<string>(\"收款账号异常\");\n   const [imgUrl, setImgUrl] = useState(\"\")\n   const [detail, setDetail] = useState<any>(null)\n   const [imgData, setImgData] = useState<any>(null)\n   const [remark, setRemark] = useState<any>(\"\")\n\n   const onChange = (e: any) => {\n      if (!e.target.files) return\n      const file = e.target.files[0];\n      if (window.FileReader) {\n         var reader = new FileReader();\n         reader.readAsDataURL(file);\n         reader.onloadend = function (e) {\n            //@ts-ignore\n            setImgData(e.target.result)\n         };\n         let data = new FormData();\n         data.append(\"file\", file, file.name)\n         setImgUrl(file)\n      }\n   }\n\n   const submit = () => {\n      if (selectValue === \"收款账号异常\" && !imgUrl) {\n         Toast.info(\"需要上传凭证\")\n         return;\n      }\n      if (!remark) {\n         Toast.info(\"需要填写备注\")\n         return;\n      }\n      const cancelReason = encodeURI(selectValue)\n      const remarks = encodeURI(remark)\n      Toast.loading(\"提交中...\")\n      if (!imgUrl) {\n         cancelTask(null, { taskId: detail.taskOrderId, cancelReason, remark: remarks }).then(data => {\n            Toast.success(\"提交成功\");\n         }).catch(err=>{\n            Toast.fail(\"提交失败\");\n         })\n         return;\n      }\n      let data = new FormData();\n      //@ts-ignore\n      data.append(\"file\", imgUrl, imgUrl.name)\n      cancelTask(data, { taskId: detail.taskOrderId, cancelReason, remark: remarks }).then(data => {\n         Toast.success(\"提交成功\");\n         goBack();\n      }).catch(err=>{\n         Toast.fail(\"提交失败\");\n      })\n   }\n   const myTaskDetailHandle = () => {\n      myTaskDetail({}).then((data: any) => {\n         setDetail(data)\n      })\n   }\n   useEffect(() => {\n      myTaskDetailHandle()\n   }, [])\n   return (\n      <>\n         <HeaderBar goback={goBack} title={\"取消付款\"} />\n         <p className=\"select-wrap\">\n            <span>取消原因*</span>\n            <select className=\"select\" onChange={(e) => setSelectValue(e.target.value)}>\n               <option value=\"收款账号异常\">收款账号异常</option>\n               <option value=\"自身资金不足\">自身资金不足</option>\n               <option value=\"其他\">其他</option>\n            </select>\n         </p>\n         <p className=\"select-wrap\">\n            <span>说明*</span>\n            <textarea rows={4} maxLength={30} className=\"select\" onChange={(e) => setRemark(e.target.value)}>\n            </textarea>\n         </p>\n         <div className=\"timer-update\">\n            <p className=\"vlidate\"><span>*</span>上传凭证</p>\n            <p className=\"update-wrap\">\n               {\n                  imgData ?\n                     <span className=\"update-img\">\n                        <img className=\"task-img\" src={imgData} />\n                        <input type=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" multiple={false} onChange={(e) => onChange(e)} />\n                     </span>\n                     :\n                     <span className=\"update-img\">\n                        <input type=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" multiple={false} onChange={(e) => onChange(e)} />\n                     </span>\n               }\n            </p>\n         </div>\n         <p className=\"submit-btn\" onClick={submit}>提交</p>\n      </>\n\n   )\n}\nexport default OffTimer;"]},"metadata":{},"sourceType":"module"}