{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _defineProperty from\"/Users/yuanfang/code/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/yuanfang/code/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _slicedToArray from\"/Users/yuanfang/code/advisory-h5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import HeaderBar from\"@components/header\";import{useHistory}from\"react-router-dom\";import{addBank}from\"./request\";import{observer,inject}from\"mobx-react\";//@ts-ignore\nimport lrz from\"lrz\";import\"./style.scss\";var Banks=function Banks(props){var banksState=props.banksState;var banks=banksState.banks;var _useHistory=useHistory(),goBack=_useHistory.goBack;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),imgUrl=_useState2[0],setImgUrl=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),imgData=_useState4[0],setImgData=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),dataInfo=_useState6[0],setDataInfo=_useState6[1];useEffect(function(){if(imgUrl){_Toast.success('添加图片成功');}},[imgUrl]);var change=function change(e,key){setDataInfo(_objectSpread(_objectSpread({},dataInfo),{},_defineProperty({},key,e.target.value)));};var _onChange=function onChange(e){if(!e.target.files)return;var file=e.target.files[0];_Toast.loading('图片上传中',1111);if(window.FileReader){var reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=function(e){//@ts-ignore\nsetImgData(e.target.result);};var data=new FormData();data.append(\"file\",file,file.name);debugger;setImgUrl(file);}};var submit=function submit(){var bankCardNo=dataInfo.bankCardNo,owner=dataInfo.owner,province=dataInfo.province,city=dataInfo.city,bankType=dataInfo.bankType,branchName=dataInfo.branchName;if(!bankCardNo||!owner||!province||!city||!bankType||!branchName){_Toast.info(\"需要填写备注\");return;}if(!imgUrl){_Toast.info(\"请上传图片\");return;}var ownerEncode=encodeURI(owner);var provinceEncode=encodeURI(province);var cityEncode=encodeURI(city);var branchNameEncode=encodeURI(branchName);var data=new FormData();lrz(imgUrl,{quality:0.1}).then(function(rst){//@ts-ignore\ndata.append(\"file\",rst.file,imgUrl.name);_Toast.loading(\"添加中...\",60);addBank(data,{bankCardNo:bankCardNo,owner:ownerEncode,province:provinceEncode,city:cityEncode,bankType:bankType,branchName:branchNameEncode}).then(function(data){_Toast.success(\"提交成功\");goBack();}).catch(function(err){_Toast.fail(err.response&&err.response.data.message||'请求出错');});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"add-banks-wrap\",children:[/*#__PURE__*/_jsx(HeaderBar,{goback:goBack,title:\"添加银行卡\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-container\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u94F6\\u884C\\u5361\\u53F7*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"item-input\",type:\"number\",onChange:function onChange(e){return change(e,'bankCardNo');},placeholder:\"\\u8BF7\\u8F93\\u516515-22\\u4F4D\\u94F6\\u884C\\u5361\\u53F7(\\u5FC5\\u586B)\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u6301\\u5361\\u4EBA*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"item-input\",onChange:function onChange(e){return change(e,'owner');},placeholder:\"\\u8BF7\\u8F93\\u5165\\u59D3\\u540D(\\u5FC5\\u586B)\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u94F6\\u884C\\u540D\\u79F0*\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"item-input\",onChange:function onChange(e){return change(e,'bankType');},placeholder:\"\\u8BF7\\u8F93\\u5165\\u94F6\\u884C\\u540D\\u79F0(\\u5FC5\\u586B)\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",style:{display:\"none\"}}),banks.map(function(b){return/*#__PURE__*/_jsx(\"option\",{value:b.code,children:b.name},b.code);})]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u5F00\\u6237\\u7701\\u4EFD*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"item-input\",onChange:function onChange(e){return change(e,'province');},placeholder:\"\\u8BF7\\u8F93\\u5165\\u5F00\\u6237\\u7701\\u4EFD(\\u5FC5\\u586B)\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u5F00\\u6237\\u57CE\\u5E02*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"item-input\",onChange:function onChange(e){return change(e,'city');},placeholder:\"\\u8BF7\\u8F93\\u5165\\u5F00\\u6237\\u57CE\\u5E02(\\u5FC5\\u586B)\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-text\",children:\"\\u652F\\u884C\\u540D\\u79F0*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"item-input\",onChange:function onChange(e){return change(e,'branchName');},placeholder:\"\\u8BF7\\u8F93\\u5165\\u652F\\u884C\\u540D\\u79F0(\\u5FC5\\u586B)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timer-update\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"vlidate\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"*\"}),\"\\u8BF7\\u4E0A\\u4F20\\u94F6\\u884C\\u5361\\u6B63\\u9762\\u7167\\u7247,\\u786E\\u4FDD\\u5361\\u53F7\\u6E05\\u6670\\u53EF\\u89C1\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"update-wrap\",children:imgData?/*#__PURE__*/_jsxs(\"span\",{className:\"update-img\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"task-img\",src:imgData}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e);}})]}):/*#__PURE__*/_jsx(\"span\",{className:\"update-img\",children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg, image/gif, image/jpg\",multiple:false,onChange:function onChange(e){return _onChange(e);}})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pay-on-btn\",onClick:function onClick(){return submit();},children:\"\\u5B8C\\u6210\"})]});};export default inject('banksState')(observer(Banks));","map":null,"metadata":{},"sourceType":"module"}