{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport \"antd-mobile/lib/action-sheet/style/css\";\nimport _ActionSheet from \"antd-mobile/lib/action-sheet\";\nimport \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport \"antd-mobile/lib/modal/style/css\";\nimport _Modal from \"antd-mobile/lib/modal\";\n\nvar _jsxFileName = \"/Users/yuanfang/Downloads/Telegram Desktop/\\u5C01\\u5B58/advisory-h5/src/pages/userInfo/component/header/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport useServiceHooks from \"@hooks/useServiceHooks\";\nimport { useHistory } from \"react-router-dom\";\nimport { observer, inject } from \"mobx-react\";\nimport { updateUserInfo, uploadHeader, logout } from \"../../request\";\nconst prompt = _Modal.prompt;\n\nconst Header = props => {\n  _s();\n\n  let {\n    onService\n  } = useServiceHooks();\n  const {\n    userState\n  } = props;\n  const history = useHistory();\n  const {\n    user,\n    updateUser\n  } = userState;\n  const {\n    push\n  } = useHistory();\n\n  const onChange = e => {\n    if (!e.target.files) return;\n\n    _Toast.loading(\"正上传头像中...\");\n\n    const file = e.target.files[0];\n    let data = new FormData();\n    data.append(\"file\", file, file.name);\n    uploadHeader(data).then(res => {\n      const {\n        data\n      } = res.data;\n      updateUser({ ...user,\n        userImg: data.url\n      });\n\n      _Toast.success(\"修改成功！\");\n    });\n  };\n\n  const to = url => {\n    push(url);\n  };\n\n  const editeRemarkHandle = params => {\n    updateUserInfo(params).then(res => {\n      _Toast.success(\"更新成功\");\n\n      updateUser({ ...user,\n        remark: params.data.remark || ''\n      });\n    });\n  };\n\n  const editNickNameHandle = params => {\n    updateUserInfo(params).then(res => {\n      _Toast.success(\"更新成功\");\n\n      updateUser({ ...user,\n        nickname: params.data.nickname || ''\n      });\n    });\n  };\n\n  const editNickName = () => {\n    return prompt('编辑昵称', '请输入新昵称', [{\n      text: '取消',\n      onPress: value => {}\n    }, {\n      text: '确定',\n      onPress: value => {\n        _Toast.loading(\"更新中....\");\n\n        editNickNameHandle({\n          data: {\n            id: user.id,\n            nickname: value\n          }\n        });\n      }\n    }]);\n  };\n\n  const editeRemark = () => {\n    return prompt('编辑签名', '请输入新签名', [{\n      text: '取消',\n      onPress: value => {}\n    }, {\n      text: '确定',\n      onPress: value => {\n        _Toast.loading(\"更新中....\");\n\n        editeRemarkHandle({\n          data: {\n            id: user.id,\n            remark: value\n          }\n        });\n      }\n    }]);\n  };\n\n  const logOutAction = () => {\n    const BUTTONS = ['退出登录', '取消'];\n\n    _ActionSheet.showActionSheetWithOptions({\n      options: BUTTONS,\n      cancelButtonIndex: BUTTONS.length - 1,\n      destructiveButtonIndex: BUTTONS.length - 2,\n      message: '',\n      maskClosable: true,\n      className: 'logId'\n    }, buttonIndex => {\n      if (buttonIndex === 1) return;\n\n      if (buttonIndex === 0) {\n        logout({}).then(res => {\n          userState.logout();\n          history.replace(\"/login\");\n\n          _Toast.success(\"已退出\");\n        });\n      }\n    });\n  }; // 头部区域\n\n\n  const topRender = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"top\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"service\",\n        onClick: onService\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"more\",\n        onClick: logOutAction,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 12\n    }, this);\n  }; // 头像区域\n\n\n  const centerRender = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"img-wrap\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/png, image/jpeg, image/gif, image/jpg\",\n          multiple: false,\n          onChange: e => onChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), user.userImg ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: user.userImg,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 28\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"img-heaer-def\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"edite\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"zh\",\n            children: \"\\u70B9\\u51FB\\u4FEE\\u6539\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: user.membershipType === 1 ? 'push' : 'push hide',\n        onClick: () => to(\"/pusher\"),\n        children: \"+\\u63A8\\u7EA2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this);\n  }; // 文字描述区域\n\n\n  const bottomRender = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bottom\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"nickname\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: user.nickname\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"edite\",\n          onClick: editNickName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"account\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u8D26\\u53F7\\uFF1A\", user.account]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"remark\",\n        children: [user.remark ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: user.remark\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 27\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: 'text',\n          children: \"\\u4E2A\\u6027\\u7B7E\\u540D:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"edite\",\n          onClick: editeRemark\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rote\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"number\",\n            children: [(user.redListHitRate * 100).toFixed(2), \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"zh\",\n            children: \"\\u7EA2\\u5355\\u7387\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"number\",\n            children: user.followNumer\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"zh\",\n            children: \"\\u5173\\u6CE8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"number\",\n            children: user.fansNumber\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"zh\",\n            children: \"\\u7C89\\u4E1D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"header\",\n    children: [topRender(), centerRender(), bottomRender()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Header, \"hqYcb3rotQmJ2DqOSjMyNdBgavc=\", false, function () {\n  return [useServiceHooks, useHistory, useHistory];\n});\n\n_c = Header;\nexport default inject('userState')(observer(Header));\n\nvar _c;\n\n$RefreshReg$(_c, \"Header\");","map":{"version":3,"sources":["/Users/yuanfang/Downloads/Telegram Desktop/封存/advisory-h5/src/pages/userInfo/component/header/index.tsx"],"names":["React","useServiceHooks","useHistory","observer","inject","updateUserInfo","uploadHeader","logout","prompt","Header","props","onService","userState","history","user","updateUser","push","onChange","e","target","files","loading","file","data","FormData","append","name","then","res","userImg","url","success","to","editeRemarkHandle","params","remark","editNickNameHandle","nickname","editNickName","text","onPress","value","id","editeRemark","logOutAction","BUTTONS","showActionSheetWithOptions","options","cancelButtonIndex","length","destructiveButtonIndex","message","maskClosable","className","buttonIndex","replace","topRender","centerRender","membershipType","bottomRender","account","redListHitRate","toFixed","followNumer","fansNumber"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport useServiceHooks from \"@hooks/useServiceHooks\"\nimport { Modal, Toast, ActionSheet } from 'antd-mobile';\nimport { useHistory } from \"react-router-dom\";\nimport { observer, inject } from \"mobx-react\"\nimport { updateUserInfo, uploadHeader, logout } from \"../../request\"\nconst prompt = Modal.prompt;\nconst Header = (props: any) => {\n  let { onService } = useServiceHooks();\n  const { userState } = props as propsData;\n  const history = useHistory();\n  const { user, updateUser } = userState as UserState;\n  const { push } = useHistory();\n\n  const onChange = (e: any) => {\n    if (!e.target.files) return\n    Toast.loading(\"正上传头像中...\")\n    const file = e.target.files[0];\n    let data = new FormData();\n    data.append(\"file\", file, file.name)\n    uploadHeader(data).then(res => {\n      const { data } = res.data;\n      updateUser({ ...user, userImg: data.url })\n      Toast.success(\"修改成功！\")\n    })\n  }\n\n  const to = (url: string) => {\n    push(url)\n  }\n\n  const editeRemarkHandle = (params: UserParams) => {\n    updateUserInfo(params).then(res => {\n      Toast.success(\"更新成功\")\n      updateUser({ ...user, remark: params.data.remark || '' })\n    })\n  }\n  const editNickNameHandle = (params: UserParams) => {\n    updateUserInfo(params).then(res => {\n      Toast.success(\"更新成功\")\n      updateUser({ ...user, nickname: params.data.nickname || '' })\n    })\n  }\n  const editNickName = () => {\n    return (\n      prompt('编辑昵称', '请输入新昵称', [\n        {\n          text: '取消',\n          onPress: value => { },\n        },\n        {\n          text: '确定',\n          onPress: value => {\n            Toast.loading(\"更新中....\")\n            editNickNameHandle({ data: { id: user.id, nickname: value } })\n          },\n        },\n      ])\n    )\n  }\n  const editeRemark = () => {\n    return (\n      prompt('编辑签名', '请输入新签名', [\n        {\n          text: '取消',\n          onPress: value => { },\n        },\n        {\n          text: '确定',\n          onPress: value => {\n            Toast.loading(\"更新中....\")\n            editeRemarkHandle({ data: { id: user.id, remark: value } })\n          },\n        },\n      ])\n    )\n  }\n\n  const logOutAction = () => {\n    const BUTTONS = ['退出登录', '取消'];\n    ActionSheet.showActionSheetWithOptions({\n      options: BUTTONS,\n      cancelButtonIndex: BUTTONS.length - 1,\n      destructiveButtonIndex: BUTTONS.length - 2,\n      message: '',\n      maskClosable: true,\n      className: 'logId',\n    },\n      (buttonIndex) => {\n        if (buttonIndex === 1) return;\n        if (buttonIndex === 0) {\n          logout({}).then(res => {\n            userState.logout();\n            history.replace(\"/login\");\n            Toast.success(\"已退出\");\n          })\n        }\n      });\n  }\n\n  // 头部区域\n  const topRender = () => {\n    return <div className=\"top\">\n      <p className=\"service\" onClick={onService}></p>\n      <p className=\"more\" onClick={logOutAction}>\n        <span></span>\n        <span></span>\n        <span></span>\n      </p>\n    </div>\n  }\n\n  // 头像区域\n  const centerRender = () => {\n    return (\n      <div className=\"center\">\n        <div className=\"img-wrap\">\n          <input type=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" multiple={false} onChange={(e) => onChange(e)} />\n          {\n            user.userImg ? <img src={user.userImg} alt=\"\" />\n              : <div className=\"img-heaer-def\">\n                <span className=\"edite\"></span>\n                <span className=\"zh\">点击修改</span>\n              </div>\n          }\n        </div>\n        <div className={user.membershipType === 1 ? 'push' : 'push hide'} onClick={() => to(\"/pusher\")}>\n          +推红\n    </div>\n      </div>\n    )\n  }\n  // 文字描述区域\n  const bottomRender = () => {\n    return (\n      <div className=\"bottom\">\n        <div className=\"nickname\">\n          <span>{user.nickname}</span>\n          <span className=\"edite\" onClick={editNickName}></span>\n        </div>\n        <div className=\"account\">\n          <span>账号：{user.account}</span>\n        </div>\n        <div className=\"remark\">\n          {\n            user.remark ? <span >{user.remark}</span>\n              : <span className={'text'}>个性签名:</span>\n          }\n          <span className=\"edite\" onClick={editeRemark}></span>\n        </div>\n        <div className=\"rote\">\n          <p>\n            <span className=\"number\">{(user.redListHitRate * 100).toFixed(2)}%</span>\n            <span className=\"zh\">红单率</span>\n          </p>\n          <p>\n            <span className=\"number\">{user.followNumer}</span>\n            <span className=\"zh\">关注</span>\n          </p>\n          <p>\n            <span className=\"number\">{user.fansNumber}</span>\n            <span className=\"zh\">粉丝</span>\n          </p>\n        </div>\n      </div>\n    )\n  }\n  return (\n    <div className=\"header\">\n      {topRender()}\n      {centerRender()}\n      {bottomRender()}\n    </div>\n  )\n}\nexport default inject('userState')((observer(Header)));"]},"metadata":{},"sourceType":"module"}